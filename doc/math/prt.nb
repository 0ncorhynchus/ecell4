(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     10509,        366]
NotebookOptionsPosition[      9417,        324]
NotebookOutlinePosition[      9750,        339]
CellTagsIndexPosition[      9707,        336]
WindowFrame->Normal
ContainsDynamic->False*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"W", "[", 
   RowBox[{"a_", ",", "b_"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"Exp", "[", " ", 
    RowBox[{
     RowBox[{"2", " ", "a", " ", "b"}], " ", "+", " ", 
     RowBox[{"b", "^", "2"}]}], " ", "]"}], " ", 
   RowBox[{"Erfc", "[", " ", 
    RowBox[{"a", " ", "+", " ", "b"}], "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"alpha", " ", ":=", " ", 
   RowBox[{
    RowBox[{"(", " ", 
     RowBox[{"1", " ", "+", " ", 
      RowBox[{"(", " ", 
       RowBox[{"k", " ", "/", " ", "kD"}], " ", ")"}]}], " ", ")"}], " ", 
    RowBox[{"(", " ", 
     RowBox[{
      RowBox[{"Sqrt", "[", "D", "]"}], " ", "/", " ", "Sigma"}], " ", 
     ")"}]}]}], "\[IndentingNewLine]"}]], "Input"],

Cell[BoxData[
 RowBox[{"kD", " ", ":=", " ", 
  RowBox[{"4", " ", "Pi", " ", "Sigma", " ", "D"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"prt", " ", ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"Exp", "[", " ", 
          RowBox[{
           RowBox[{"-", " ", 
            RowBox[{
             RowBox[{"(", " ", 
              RowBox[{"r", " ", "-", " ", "r0"}], " ", ")"}], " ", "^", 
             "2"}]}], " ", "/", " ", 
           RowBox[{"(", 
            RowBox[{"4", " ", "D", " ", "t"}], ")"}]}], " ", "]"}], " ", "+", 
         " ", 
         RowBox[{"Exp", "[", " ", 
          RowBox[{
           RowBox[{"-", " ", 
            RowBox[{
             RowBox[{"(", " ", 
              RowBox[{"r", " ", "+", " ", "r0", " ", "-", " ", 
               RowBox[{"2", " ", "Sigma"}]}], " ", ")"}], " ", "^", " ", 
             "2"}]}], " ", "/", " ", 
           RowBox[{"(", 
            RowBox[{"4", " ", "D", " ", "t"}], ")"}]}], " ", "]"}]}], "  ", 
        ")"}], " ", "/", " ", 
       RowBox[{"Sqrt", "[", " ", 
        RowBox[{"4", " ", "Pi", " ", "t"}], "]"}]}], " ", "-", " ", 
      RowBox[{"alpha", " ", 
       RowBox[{"W", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"r", "+", "r0", " ", "-", " ", 
            RowBox[{"2", " ", "Sigma"}]}], " ", ")"}], " ", "/", " ", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"4", " ", "D", " ", "t"}], "]"}]}], ",", " ", 
         RowBox[{"alpha", " ", 
          RowBox[{"Sqrt", "[", "t", "]"}]}]}], " ", "]"}]}]}], " ", ")"}], 
    " ", "/", " ", 
    RowBox[{"(", " ", 
     RowBox[{"4", " ", "Pi", " ", "r", " ", "r0", " ", 
      RowBox[{"Sqrt", "[", "D", "]"}]}], " ", ")"}]}], " "}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Integrate", "[", 
  RowBox[{"prt", ",", "t"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"4", " ", 
    SqrtBox["D"], " ", "\[Pi]", " ", "r", " ", "r0"}]], 
  RowBox[{"(", 
   RowBox[{"\[Integral]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"-", 
           FractionBox[
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"r", "-", "r0"}], ")"}], "2"], 
            RowBox[{"4", " ", "D", " ", "t"}]]}]], "+", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"-", 
           FractionBox[
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"r", "+", "r0", "-", 
               RowBox[{"2", " ", "Sigma"}]}], ")"}], "2"], 
            RowBox[{"4", " ", "D", " ", "t"}]]}]]}], 
        RowBox[{"2", " ", 
         SqrtBox["\[Pi]"], " ", 
         SqrtBox["t"]}]], "-", 
       RowBox[{
        FractionBox["1", "Sigma"], 
        RowBox[{"(", 
         RowBox[{
          SqrtBox["D"], " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            FractionBox[
             RowBox[{"D", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 FractionBox["k", 
                  RowBox[{"4", " ", "D", " ", "\[Pi]", " ", "Sigma"}]]}], 
                ")"}], "2"], " ", "t"}], 
             SuperscriptBox["Sigma", "2"]], "+", 
            FractionBox[
             RowBox[{
              SqrtBox["D"], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                FractionBox["k", 
                 RowBox[{"4", " ", "D", " ", "\[Pi]", " ", "Sigma"}]]}], 
               ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"r", "+", "r0", "-", 
                RowBox[{"2", " ", "Sigma"}]}], ")"}], " ", 
              SqrtBox["t"]}], 
             RowBox[{"Sigma", " ", 
              SqrtBox[
               RowBox[{"D", " ", "t"}]]}]]}]], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            FractionBox["k", 
             RowBox[{"4", " ", "D", " ", "\[Pi]", " ", "Sigma"}]]}], ")"}], 
          " ", 
          RowBox[{"Erfc", "[", 
           RowBox[{
            FractionBox[
             RowBox[{
              SqrtBox["D"], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                FractionBox["k", 
                 RowBox[{"4", " ", "D", " ", "\[Pi]", " ", "Sigma"}]]}], 
               ")"}], " ", 
              SqrtBox["t"]}], "Sigma"], "+", 
            FractionBox[
             RowBox[{"r", "+", "r0", "-", 
              RowBox[{"2", " ", "Sigma"}]}], 
             RowBox[{"2", " ", 
              SqrtBox[
               RowBox[{"D", " ", "t"}]]}]]}], "]"}]}], ")"}]}]}], ")"}], 
     RowBox[{"\[DifferentialD]", "t"}]}]}], ")"}]}]], "Output"]
}, Open  ]],

Cell[BoxData[""], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", " ", 
      RowBox[{"Exp", "[", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"r", " ", "-", "r0"}], ")"}], " ", "^", "2"}], " ", "]"}], 
      "    ", ")"}], "/", "r"}], ",", " ", "r"}], "]"}], " "}]], "Input"],

Cell[BoxData[
 RowBox[{"\[Integral]", 
  RowBox[{
   FractionBox[
    SuperscriptBox["\[ExponentialE]", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"r", "-", "r0"}], ")"}], "2"]], "r"], 
   RowBox[{"\[DifferentialD]", "r"}]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", " ", 
  RowBox[{",", "r"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"2", " ", 
  SuperscriptBox["\[ExponentialE]", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"r", "-", "r0"}], ")"}], "2"]], " ", 
  RowBox[{"(", 
   RowBox[{"r", "-", "r0"}], ")"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Integrate[(Exp[r^2] /r ) (Exp[ - 2 r r0]/r) (Exp[ r0^2] /r), r]\
\>", "Input"],

Cell[BoxData[
 RowBox[{"\[Integral]", 
  RowBox[{
   FractionBox[
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      SuperscriptBox["r", "2"], "-", 
      RowBox[{"2", " ", "r", " ", "r0"}], "+", 
      SuperscriptBox["r0", "2"]}]], 
    SuperscriptBox["r", "3"]], 
   RowBox[{"\[DifferentialD]", "r"}]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x", "-", "a"}], ")"}], "^", "2"}], "]"}], " ", "-", " ", 
     RowBox[{"Integrate", "[", " ", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"(", " ", 
         RowBox[{"x", "-", "a"}], ")"}], " ", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"x", "-", "a"}], ")"}], "^", "2"}], "]"}]}], ",", "x"}], 
      "]"}], " ", "+", " ", 
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"x", "-", "a"}], ")"}], "^", "2"}], "]"}], "/", "x"}], ",",
        "x"}], "]"}]}], ",", "x"}], "]"}], "\[IndentingNewLine]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", 
   SuperscriptBox["\[ExponentialE]", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"a", "-", "x"}], ")"}], "2"]], " ", 
   RowBox[{"(", 
    RowBox[{"a", "-", "x"}], ")"}]}], "+", 
  FractionBox[
   SuperscriptBox["\[ExponentialE]", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "a"}], "+", "x"}], ")"}], "2"]], "x"], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["\[ExponentialE]", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "a"}], "+", "x"}], ")"}], "2"]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "a"}], "+", "x"}], ")"}]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"Simplify", "[", "%", "]"}]}]], "Input"],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["\[ExponentialE]", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"a", "-", "x"}], ")"}], "2"]], "x"]], "Output"]
}, Open  ]],

Cell[BoxData["\[IndentingNewLine]"], "Input"]
},
WindowSize->{890, 689},
WindowMargins->{{Automatic, 32}, {Automatic, 25}},
FrontEndVersion->"6.0 for Linux x86 (64-bit) (June 19, 2007)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[568, 21, 347, 10, 32, "Input"],
Cell[918, 33, 387, 11, 55, "Input"],
Cell[1308, 46, 109, 2, 32, "Input"],
Cell[1420, 50, 1695, 46, 77, "Input"],
Cell[CellGroupData[{
Cell[3140, 100, 87, 2, 32, "Input"],
Cell[3230, 104, 2860, 83, 282, "Output"]
}, Open  ]],
Cell[6105, 190, 26, 0, 32, "Input"],
Cell[CellGroupData[{
Cell[6156, 194, 322, 10, 32, "Input"],
Cell[6481, 206, 252, 8, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6770, 219, 77, 2, 32, "Input"],
Cell[6850, 223, 223, 7, 38, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7110, 235, 88, 2, 32, "Input"],
Cell[7201, 239, 326, 10, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7564, 254, 821, 26, 55, "Input"],
Cell[8388, 282, 666, 23, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9091, 310, 97, 2, 55, "Input"],
Cell[9191, 314, 162, 5, 55, "Output"]
}, Open  ]],
Cell[9368, 322, 45, 0, 55, "Input"]
}
]
*)

(* End of internal cache information *)

