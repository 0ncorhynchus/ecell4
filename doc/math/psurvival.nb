(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     14651,        490]
NotebookOptionsPosition[     13409,        442]
NotebookOutlinePosition[     13764,        458]
CellTagsIndexPosition[     13721,        455]
WindowFrame->Normal
ContainsDynamic->False*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"$Assumptions", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"r", ">", "0"}], ",", 
    RowBox[{"r0", ">", "0"}], ",", 
    RowBox[{"u", ">", "0"}], ",", 
    RowBox[{"s", ">", "0"}], ",", 
    RowBox[{"r", ">", "s"}], ",", " ", 
    RowBox[{"r0", ">", "s"}], ",", " ", 
    RowBox[{"D", ">", "0"}], ",", 
    RowBox[{"t", ">", "0"}], ",", " ", 
    RowBox[{"k", ">", "0"}], ",", " ", 
    RowBox[{"kD", ">", "0"}], ",", " ", 
    RowBox[{"alpha", ">", "0"}]}], "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"W", "[", 
     RowBox[{"a_", ",", "b_"}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"Exp", "[", " ", 
      RowBox[{
       RowBox[{"2", " ", "a", " ", "b"}], " ", "+", " ", 
       RowBox[{"b", "^", "2"}]}], " ", "]"}], " ", 
     RowBox[{"Erfc", "[", " ", 
      RowBox[{"a", " ", "+", " ", "b"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"psurvival", " ", ":=", " ", 
    RowBox[{
     RowBox[{"1", " ", "-", " ", 
      RowBox[{
       RowBox[{"(", " ", 
        RowBox[{"s", " ", "/", " ", "r0"}], " ", ")"}], " ", 
       RowBox[{"(", " ", 
        RowBox[{"k", " ", "/", " ", 
         RowBox[{"(", " ", 
          RowBox[{"k", " ", "+", " ", "kD"}], " ", ")"}]}], " ", ")"}], " ", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"Erfc", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"r0", "-", "s"}], ")"}], "/", 
           RowBox[{"Sqrt", "[", " ", 
            RowBox[{"4", " ", "D", " ", "t"}], " ", "]"}]}], " ", "]"}], " ", 
         "-", " ", 
         RowBox[{"W", "[", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"r0", " ", "-", " ", "s"}], ")"}], " ", "/", " ", 
            RowBox[{"Sqrt", "[", " ", 
             RowBox[{"4", " ", "D", " ", "t"}], "]"}]}], ",", " ", 
           RowBox[{"alpha", " ", 
            RowBox[{"Sqrt", "[", "t", "]"}]}]}], " ", "]"}]}], " ", ")"}]}]}],
      " ", "//", " ", "Simplify"}]}]}]}]], "Input",
 CellChangeTimes->{{3.410046559943474*^9, 3.4100465599825087`*^9}, {
  3.41004728492876*^9, 3.4100472871259623`*^9}}],

Cell[CellGroupData[{

Cell[BoxData["psurvival"], "Input",
 CellChangeTimes->{{3.410047279242782*^9, 3.410047291237349*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"k", "+", "kD"}], ")"}], " ", "r0"}], "-", 
   RowBox[{"k", " ", "s", " ", 
    RowBox[{"Erfc", "[", 
     FractionBox[
      RowBox[{"r0", "-", "s"}], 
      RowBox[{"2", " ", 
       SqrtBox[
        RowBox[{"D", " ", "t"}]]}]], "]"}]}], "+", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"alpha", " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{"r0", "-", "s"}], 
         SqrtBox["D"]], "+", 
        RowBox[{"alpha", " ", "t"}]}], ")"}]}]], " ", "k", " ", "s", " ", 
    RowBox[{"Erfc", "[", 
     RowBox[{
      RowBox[{"alpha", " ", 
       SqrtBox["t"]}], "+", 
      FractionBox[
       RowBox[{"r0", "-", "s"}], 
       RowBox[{"2", " ", 
        SqrtBox[
         RowBox[{"D", " ", "t"}]]}]]}], "]"}]}]}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"k", "+", "kD"}], ")"}], " ", "r0"}]]], "Output",
 CellChangeTimes->{
  3.410046495912209*^9, 3.4100465689195547`*^9, {3.4100472779476337`*^9, 
   3.4100472916656027`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dpsurvival", " ", "=", " ", 
  RowBox[{"D", "[", 
   RowBox[{"psurvival", ",", "t"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"k", "+", "kD"}], ")"}], " ", "r0"}]], 
   RowBox[{"k", " ", "s", " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"D", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"-", 
          FractionBox[
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"r0", "-", "s"}], ")"}], "2"], 
           RowBox[{"4", " ", "D", " ", "t"}]]}]], " ", 
        RowBox[{"(", 
         RowBox[{"r0", "-", "s"}], ")"}]}], 
       RowBox[{"2", " ", 
        SqrtBox["\[Pi]"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"D", " ", "t"}], ")"}], 
         RowBox[{"3", "/", "2"}]]}]], "+", 
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{
           SuperscriptBox["alpha", "2"], " ", "t"}], "+", 
          FractionBox[
           RowBox[{"alpha", " ", 
            RowBox[{"(", 
             RowBox[{"r0", "-", "s"}], ")"}], " ", 
            SqrtBox["t"]}], 
           SqrtBox[
            RowBox[{"D", " ", "t"}]]], "-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"alpha", " ", 
              SqrtBox["t"]}], "+", 
             FractionBox[
              RowBox[{"r0", "-", "s"}], 
              RowBox[{"2", " ", 
               SqrtBox[
                RowBox[{"D", " ", "t"}]]}]]}], ")"}], "2"]}]], " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox["alpha", 
           RowBox[{"2", " ", 
            SqrtBox["t"]}]], "-", 
          FractionBox[
           RowBox[{"D", " ", 
            RowBox[{"(", 
             RowBox[{"r0", "-", "s"}], ")"}]}], 
           RowBox[{"4", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"D", " ", "t"}], ")"}], 
             RowBox[{"3", "/", "2"}]]}]]}], ")"}]}], 
       SqrtBox["\[Pi]"]], "-", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{
          SuperscriptBox["alpha", "2"], " ", "t"}], "+", 
         FractionBox[
          RowBox[{"alpha", " ", 
           RowBox[{"(", 
            RowBox[{"r0", "-", "s"}], ")"}], " ", 
           SqrtBox["t"]}], 
          SqrtBox[
           RowBox[{"D", " ", "t"}]]]}]], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["alpha", "2"], "-", 
         FractionBox[
          RowBox[{"alpha", " ", "D", " ", 
           RowBox[{"(", 
            RowBox[{"r0", "-", "s"}], ")"}], " ", 
           SqrtBox["t"]}], 
          RowBox[{"2", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"D", " ", "t"}], ")"}], 
            RowBox[{"3", "/", "2"}]]}]], "+", 
         FractionBox[
          RowBox[{"alpha", " ", 
           RowBox[{"(", 
            RowBox[{"r0", "-", "s"}], ")"}]}], 
          RowBox[{"2", " ", 
           SqrtBox["t"], " ", 
           SqrtBox[
            RowBox[{"D", " ", "t"}]]}]]}], ")"}], " ", 
       RowBox[{"Erfc", "[", 
        RowBox[{
         RowBox[{"alpha", " ", 
          SqrtBox["t"]}], "+", 
         FractionBox[
          RowBox[{"r0", "-", "s"}], 
          RowBox[{"2", " ", 
           SqrtBox[
            RowBox[{"D", " ", "t"}]]}]]}], "]"}]}]}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{3.410046495985285*^9, 3.41004656905287*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", "dpsurvival", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"alpha", " ", "D", " ", "k", " ", "s", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SqrtBox["D"]}], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"r0", "-", "s"}], ")"}], "2"], 
          RowBox[{"4", " ", "D", " ", "t"}]]}]], " ", "t"}], "+", 
      RowBox[{"alpha", " ", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"alpha", " ", 
          RowBox[{"(", 
           RowBox[{"r0", "-", "s", "+", 
            RowBox[{"alpha", " ", 
             SqrtBox["D"], " ", "t"}]}], ")"}]}], 
         SqrtBox["D"]]], " ", 
       SqrtBox["\[Pi]"], " ", 
       SqrtBox[
        RowBox[{"D", " ", 
         SuperscriptBox["t", "3"]}]], " ", 
       RowBox[{"Erfc", "[", 
        FractionBox[
         RowBox[{"r0", "-", "s", "+", 
          RowBox[{"2", " ", "alpha", " ", 
           SqrtBox["D"], " ", "t"}]}], 
         RowBox[{"2", " ", 
          SqrtBox[
           RowBox[{"D", " ", "t"}]]}]], "]"}]}]}], ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"k", "+", "kD"}], ")"}], " ", 
    SqrtBox["\[Pi]"], " ", "r0", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"D", " ", "t"}], ")"}], 
     RowBox[{"3", "/", "2"}]]}], ")"}]}]], "Output",
 CellChangeTimes->{3.4100464967758512`*^9, 3.410046569822997*^9}]
}, Open  ]],

Cell[BoxData[""], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"alpha", " ", "k", " ", "s", " ", 
    RowBox[{
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"-", 
          FractionBox[
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"r0", "-", "s"}], ")"}], "2"], 
           RowBox[{"4", " ", "D", " ", "t"}]]}]]}], " ", "+", " ", 
       RowBox[{"alpha", " ", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"Pi", " ", "t"}], "]"}], " ", 
        RowBox[{"W", "[", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"r0", " ", "-", " ", "s"}], ")"}], " ", "/", " ", 
           RowBox[{"Sqrt", "[", " ", 
            RowBox[{"4", " ", "D", " ", "t"}], "]"}]}], ",", " ", 
          RowBox[{"alpha", " ", 
           RowBox[{"Sqrt", "[", "t", "]"}]}]}], " ", "]"}]}]}], " ", ")"}], 
     " ", "/", " ", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{"Pi", " ", "t"}], "]"}], " ", "r0", " ", 
       RowBox[{"(", " ", 
        RowBox[{"k", " ", "+", " ", "kD"}], " ", ")"}]}], " ", ")"}]}]}], " ",
    "\[Equal]", " ", "dpsurvival"}], " ", "]"}]], "Input",
 CellChangeTimes->{{3.410046560258493*^9, 3.4100465602627287`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.410046497427053*^9, 3.410046593661746*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"psurvival", "-", "u"}], ",", "t"}], "]"}], " ", "\[Equal]", 
    " ", "dpsurvival"}], "]"}]}]], "Input"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.410046497515979*^9, 3.4100465940383463`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["psurvival"], "Input",
 CellChangeTimes->{{3.4100465387565117`*^9, 3.4100465401572323`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"k", "+", "kD"}], ")"}], " ", "r0"}], "-", 
   RowBox[{"k", " ", "s", " ", 
    RowBox[{"Erfc", "[", 
     FractionBox[
      RowBox[{"r0", "-", "s"}], 
      RowBox[{"2", " ", 
       SqrtBox[
        RowBox[{"D", " ", "t"}]]}]], "]"}]}], "+", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"alpha", " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{"r0", "-", "s"}], 
         SqrtBox["D"]], "+", 
        RowBox[{"alpha", " ", "t"}]}], ")"}]}]], " ", "k", " ", "s", " ", 
    RowBox[{"Erfc", "[", 
     RowBox[{
      RowBox[{"alpha", " ", 
       SqrtBox["t"]}], "+", 
      FractionBox[
       RowBox[{"r0", "-", "s"}], 
       RowBox[{"2", " ", 
        SqrtBox[
         RowBox[{"D", " ", "t"}]]}]]}], "]"}]}]}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"k", "+", "kD"}], ")"}], " ", "r0"}]]], "Output",
 CellChangeTimes->{3.410046540672441*^9, 3.410046594093136*^9, 
  3.410047296044636*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Limit", "[", 
  RowBox[{
   RowBox[{"psurvival", " ", "/.", " ", 
    RowBox[{"r0", "\[Rule]", "s"}]}], " ", ",", " ", 
   RowBox[{"t", "\[Rule]", "Infinity"}]}], " ", "]"}]], "Input",
 CellChangeTimes->{{3.4100466632566566`*^9, 3.410046707528758*^9}}],

Cell[BoxData[
 FractionBox["kD", 
  RowBox[{"k", "+", "kD"}]]], "Output",
 CellChangeTimes->{{3.410046669710333*^9, 3.4100467080244617`*^9}, 
   3.410047307947596*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{"psurvival", " ", ",", " ", 
    RowBox[{"t", "\[Rule]", "Infinity"}]}], "]"}], "//", " ", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.410046602513481*^9, 3.4100466187180433`*^9}, {
  3.4100467172962503`*^9, 3.4100467188898497`*^9}, {3.4100475307906857`*^9, 
  3.4100475614612093`*^9}}],

Cell[BoxData[
 RowBox[{"1", "-", 
  FractionBox[
   RowBox[{"k", " ", "s"}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"k", "+", "kD"}], ")"}], " ", "r0"}]]}]], "Output",
 CellChangeTimes->{
  3.410046608292542*^9, 3.4100466686144238`*^9, 3.410047270132113*^9, 
   3.410047310775991*^9, 3.410047369112982*^9, {3.410047532939485*^9, 
   3.4100475618918056`*^9}}]
}, Open  ]]
},
WindowSize->{892, 972},
WindowMargins->{{147, Automatic}, {Automatic, 24}},
Magnification->1.25,
FrontEndVersion->"6.0 for Linux x86 (64-bit) (June 19, 2007)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[568, 21, 505, 14, 64, "Input"],
Cell[1076, 37, 1651, 43, 164, "Input"],
Cell[CellGroupData[{
Cell[2752, 84, 101, 1, 38, "Input"],
Cell[2856, 87, 1063, 36, 114, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3956, 128, 128, 3, 38, "Input"],
Cell[4087, 133, 3423, 107, 453, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7547, 245, 70, 1, 38, "Input"],
Cell[7620, 248, 1491, 46, 212, "Output"]
}, Open  ]],
Cell[9126, 297, 26, 0, 38, "Input"],
Cell[CellGroupData[{
Cell[9177, 301, 1323, 35, 201, "Input"],
Cell[10503, 338, 95, 1, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10635, 344, 243, 7, 64, "Input"],
Cell[10881, 353, 97, 1, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11015, 359, 105, 1, 38, "Input"],
Cell[11123, 362, 1029, 35, 114, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12189, 402, 276, 6, 38, "Input"],
Cell[12468, 410, 167, 4, 76, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12672, 419, 355, 8, 38, "Input"],
Cell[13030, 429, 363, 10, 79, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
